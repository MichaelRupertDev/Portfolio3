<head>
<meta charset="utf-8" />
<title>HTML5 Canvas Drawing Board</title>
<script type="text/JavaScript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js?ver=1.4.2"></script>
</head>
<body>
	<canvas id="myCanvas" style="border:1px solid #000000;">
		Sorry, your browser does not support HTML5 canvas technology.
	</canvas>

	<div id="tools" style="position:absolute;left:1050px;top:5px;height:900px;width:100px;border-style:inset;background-color:#DCDCDC;">
		<button id="white" style="height:47px;width:47px;background-color:#FFFFFF;">     </button>
		<button id="black" style="height:47px;width:47px;background-color:#000000;">     </button>
		<button id="red" style="height:47px;width:47px;background-color:#FF0000;">     </button>
		<button id="orange" style="height:47px;width:47px;background-color:#FF8000;">     </button>
		<button id="yellow" style="height:47px;width:47px;background-color:#FFFF00;">     </button>
		<button id="green" style="height:47px;width:47px;background-color:#00FF00;">     </button>
		<button id="blue" style="height:47px;width:47px;background-color:#0000FF;">     </button>
		<button id="gray" style="height:47px;width:47px;background-color:#BDBDBD;">     </button>
		<button id="pink" style="height:47px;width:47px;background-color:#FE2EF7;">     </button>
		<button id="purple" style="height:47px;width:47px;background-color:#B404AE;">     </button>
	</div>
	<script src="https://cdn.socket.io/socket.io-1.2.0.js"></script>
    <script src="http://code.jquery.com/jquery-1.11.1.js"></script>
	<script>
	$(document).ready(function(){
		color = "#000000";
		$("#white").click(function(){
			color = "#FFFFFF";
			console.log(color);
		});
		$("#black").click(function(){
			color = "#000000";
			console.log(color);
		});
		$("#red").click(function(){
			color = "#FF0000";
			console.log(color);
		});
		$("#orange").click(function(){
			color = "#FF8000";
			console.log(color);
		});
	});
	</script>
	<script>
		window.onload = function() {
		var myCanvas = document.getElementById("myCanvas");
		var ctx = myCanvas.getContext("2d");
	    // Fill Window Width and Height
	    myCanvas.width = 1024;
		myCanvas.height = 900;
		
		// Set Background Color
	    ctx.fillStyle="#fff";
	    ctx.fillRect(0,0,myCanvas.width,myCanvas.height);
		
	    function Point(x, y) {
  			this.x = x;
  			this.y = y;
		}

	    function Shape(points, color, brush) {
	    	this.points = points;
	    	this.color = color;
	    	this.brush = brush;
	    }

	    // Mouse Event Handlers
		if(myCanvas){
			var socket = io();
      		socket.on('shape', function(Shape){
      			ctx.strokeStyle = Shape.color;
      			console.log(Shape);
      			console.log("Recieved shape color: " + Shape.color);
      			for(var i = 0; i < Shape.points.length - 1; i ++){
      				ctx.beginPath();
      				var startX = Shape.points[i].x;
      				var endX = Shape.points[i+1].x;
      				var startY = Shape.points[i].y;
      				var endY = Shape.points[i+1].y;
      				ctx.moveTo(startX, startY);
      				ctx.lineTo(endX, endY);
      				ctx.stroke();
       			}
      		});

			var isDown = false;
			var canvasX, canvasY;
			ctx.lineWidth = 5;
			var points = [];

			$(myCanvas)
			.mousedown(function(e){
				isDown = true;
				points = [];
				canvasX = e.pageX - myCanvas.offsetLeft;
				canvasY = e.pageY - myCanvas.offsetTop;
				points.push(new Point(canvasX, canvasY));
			})
			.mousemove(function(e){
				if(isDown !== false) {
					canvasX = e.pageX - myCanvas.offsetLeft;
					canvasY = e.pageY - myCanvas.offsetTop;
					points.push(new Point(canvasX, canvasY));
				}
			})
			.mouseup(function(e){
				isDown = false;
				var shape = new Shape(points, color, "draw");
				console.log(shape);
				socket.emit('shape', shape);
			});
		}


	};
	</script>
</script>
</body>
</html>
